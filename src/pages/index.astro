---
interface Article {
	id: number;
	title: string;
	description: string;
	slug: string;
	createdAt: string;
	updatedAt: string;
	publishedAt: string;
	cover: {
		url: string;
		formats: {
			thumbnail: { url: string };
			small: { url: string };
			medium: { url: string };
			large: { url: string };
		};
	};
	author: {
		name: string;
		email: string;
	};
	category: {
		name: string;
		slug: string;
	};
}

// Fetch articles from Strapi
const response = await fetch('http://localhost:1337/api/articles?populate=*');
const data = await response.json();
const articles = Array.isArray(data.data) ? data.data as Article[] : [];
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Articles</title>
	</head>
	<body class="bg-gray-100 min-h-screen">
		<div class="container mx-auto px-4 py-8">
			<h1 class="text-4xl font-bold text-gray-800 mb-8">Articles</h1>
			<div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
				{articles.map((article: Article) => (
					<a href={`/articles/${article.slug}`} class="block group">
						<article class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-200">
							<div class="aspect-w-16 aspect-h-9">
								<img
									src={`http://localhost:1337${article.cover.formats.medium.url}`}
									alt={article.title}
									class="w-full h-48 object-cover"
								/>
							</div>
							<div class="p-6">
								<div class="flex items-center gap-2 mb-2">
									<span class="px-2 py-1 text-xs font-semibold text-blue-600 bg-blue-100 rounded-full">
										{article.category.name}
									</span>
									<span class="text-sm text-gray-500">by {article.author.name}</span>
								</div>
								<h2 class="text-xl font-semibold text-gray-800 mb-2 group-hover:text-blue-600 transition-colors">
									{article.title}
								</h2>
								<p class="text-gray-600 line-clamp-2">{article.description}</p>
							</div>
						</article>
					</a>
				))}
			</div>
		</div>
	</body>
</html>
